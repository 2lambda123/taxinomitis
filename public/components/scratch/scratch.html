<div ng-if="!isAuthenticated">
    <div class="alert alert-warning pageheadermsg">
        <strong>Not logged in</strong>
    </div>
    <div class="text-center">
        <button class="btn btn-primary" ng-click="vm.authService.login()">Log In</button>
    </div>
</div>

<div ng-if="isAuthenticated && !projectId" class="alert alert-danger pageheadermsg">
    <strong>Error:</strong> Missing project id. Go back to <a ui-sref="projects">your projects</a>
</div>

<div ng-if="isAuthenticated && projectId">
    <div class="jumbotron">
        <h2 class="text-center">Using machine learning in Scratch</h2>
    </div>
    <div class="backbutton">
        <a ui-sref="mlproject({ projectId : projectId })">&lt; Back to project</a>
    </div>

    <div ng-repeat="error in vm.errors" class="alert alert-danger alert-dismissible pageheadermsg" role="alert" ng-click="vm.dismissAlert('errors', $index)">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <strong>Error:</strong> {{ error.message }}
    </div>
    <div ng-repeat="warning in vm.warnings" class="alert alert-warning alert-dismissible pageheadermsg" role="alert" ng-click="vm.dismissAlert('warnings', $index)">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <strong>Warning:</strong> {{ warning.message }}
    </div>

    <div ng-if="projectId && !project" class="loading"> </div>

    <div ng-if="project && project.labels.length <= 1" class="modelguidancecontainer">
        <div class="modelguidance">
            <div class="modelstatusdetail">
                Your project isn't ready to be used in Scratch yet.
            </div>
            <div class="modelstatusdetail">
                Go to the <a ui-sref="mlproject_models({ projectId : projectId })">Learn &amp; Test</a>
                page for some tips on what to do next.
            </div>
        </div>
    </div>

    <div ng-if="project && project.labels.length > 1" class="modelguidancecontainer">
        <div class="modelguidance">
            <div class="modelstatusdetail">
                Your project will add these blocks to the
                <span style="background-color: purple; color: white; padding-left: 5px; padding-right: 5px;">More Blocks</span>
                tab in Scripts.
            </div>
            <div class="scratchblocks">
                recognise {{project.type}} [{{project.type}}] \(label) :: custom reporter
            </div>
            <div class="modelstatusdetail">
                Put {{ project.type }} in the input for this, and it will return the label that your machine learning model recognises it as.
            </div>
            <div class="scratchblocks">
                recognise {{project.type}} [{{project.type}}] \(confidence) :: custom reporter
            </div>
            <div class="modelstatusdetail">
                This will return how confident your machine learning model is that it recognises the type of {{ project.type }}. (As a number from 0 - 100).
            </div>
            <div class="scratchblocks" style="float: left" ng-repeat="label in project.labels">
                {{label}} :: custom reporter
            </div>
            <div class="modelstatusdetail" style="clear: both;">
                These blocks represent the labels you've created in your project, so you can use their names in your scripts.
            </div>
            <div class="modelstatusdetail">
                <strong>This means you can do something like this:</strong>
            </div>
            <div class="scratchblocks">
                ask [enter some text here] and wait
                if &lt;{recognise {{project.type}} [{{project.type}}] \(label) :: custom reporter } = ({{project.labels[0]}} :: custom reporter)&gt; then
                say [I think that was {{project.labels[0]}}]
            </div>
        </div>
        <div class="modelguidance">
            <div class="modelstatusdetail">
                It will look something like this - except with the name of your project.
            </div>
            <div class="modelstatusdetail">
                <img src="images/scratch-screenshot.png">
            </div>
            <div class="modelstatusdetail">
                The coloured circle next to your project name tells you if your machine learning model is okay.
            </div>
            <div class="modelstatusdetail">
                <ul>
                    <li><div class="statusicon ok"> </div> means your model is trained and ready to go
                    <li><div class="statusicon notready"> </div>  means your model hasn't finished training yet
                    <li><div class="statusicon error"> </div>  means something went wrong. Go back to the <a ui-sref="mlproject_models({ projectId : projectId })">Learn &amp; Test</a> page to see what went wrong with training.
                </ul>
            </div>
        </div>
    </div>
    <div ng-if="project && project.labels.length > 1" style="margin: 5em;">
        <div ng-if="scratchkey">
            <div ng-if="!scratchkey.model">
                <div class="alert alert-info" role="alert">
                    You haven't trained a machine learning model yet.
                </div>
                <div>
                    You can <strong><a href="" ui-sref="mlproject_models({ projectId : projectId })">train one now</a></strong> and then come back to open Scratch.
                </div>
                <div>
                    Or you can go <strong><a target="_blank" href="{{ scratchkey.url }}">straight into Scratch</a></strong> now. It just means that the computer will make random guesses as you haven't trained it to recognise things yet.
                </div>
            </div>
            <div ng-if="scratchkey.model">
                <a target="_blank" href="{{ scratchkey.url }}">{{ scratchkey.url }}</a>
            </div>
        </div>
        <button ng-if="!scratchkey"
                class="btn btn-primary"
                ng-click="vm.getScratchKey($event, project)">Open in Scratch</button>
    </div>
</div>

